{{ if .Site.Params.newsletter.enable }}
<section class="section-sm newsletter-section">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto text-center">
        <h2>{{ .Site.Params.newsletter.title | markdownify }}</h2>
        <p class="text-light px-md-5 py-4 border-left border-right border-primary">
          {{ .Site.Params.newsletter.content | markdownify }}</p>
        <form action="{{ .Site.Params.newsletter.action }}" method="post"
          class="row justify-content-center newsletter-form" id="newsletter-form">
          <div class="input-group col-md-8">
            <input type="email" name="email" class="form-control" placeholder="您的電子郵件地址" required>
            <div class="input-group-append">
              <button type="submit" class="input-group-text btn btn-primary">訂閱</button>
            </div>
          </div>
          <div class="col-12 newsletter-response mt-2" id="newsletter-response"></div>
        </form>
      </div>
    </div>
  </div>
</section>
{{ end }}

<footer class="text-capitalize footer-section">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="{{ .Site.BaseURL }}" aria-label="{{ .Site.Title }}">
          {{ if .Site.Params.logo }}
          <img loading="lazy" src="{{ .Site.Params.logo | absURL }}" alt="{{ .Site.Title }}" class="footer-logo">
          {{ else }}
          <h3>{{ .Site.Title }}</h3>
          {{ end }}
        </a>
      </div>
      {{ if or .Site.Params.mobile .Site.Params.location .Site.Params.email }}
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">聯絡我們</h6>
        <ul class="list-unstyled contact-list">
          {{ if .Site.Params.mobile }}
          <li class="mb-3">
            <a class="text-dark d-flex align-items-center cursor-pointer" href="tel:{{ .Site.Params.mobile }}">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="text-primary mr-2" style="width: 20px; height: 20px;">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" />
              </svg>
              {{ .Site.Params.mobile }}
            </a>
          </li>
          {{ end }}
          {{ if .Site.Params.location }}
          <li class="mb-3 d-flex align-items-center">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor" class="text-primary mr-2" style="width: 20px; height: 20px;">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
            </svg>
            {{ .Site.Params.location }}
          </li>
          {{ end }}
          {{ if .Site.Params.email }}
          <li class="mb-3">
            <a class="text-dark d-flex align-items-center cursor-pointer" href="mailto:{{ .Site.Params.email }}">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="text-primary mr-2" style="width: 20px; height: 20px;">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
              </svg>
              {{ .Site.Params.email }}
            </a>
          </li>
          {{ end }}
        </ul>
      </div>
      {{ end }}
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">社群連結</h6>
        <ul class="list-unstyled social-list">
          {{ range .Site.Params.social }}
          <li class="mb-3">
            <a class="text-dark social-item" href="{{ .link | safeURL }}" {{ if .target }}target="{{ .target }}" {{ end
              }}>
              {{ if .icon }}<i class="{{ .icon }}"></i>{{ end }}{{ .title }}
            </a>
          </li>
          {{ end }}
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">文章分類</h6>
        <ul class="list-unstyled category-list">
          <li class="mb-3">
            <a class="text-dark category-item" href="{{ `categories/` | relLangURL }}">
              查看所有分類
            </a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">快速連結</h6>
        <ul class="list-unstyled quick-links">
          {{ range .Site.Menus.footer }}
          <li class="mb-3">
            <a class="text-dark" href="{{ .URL | absURL }}">
              {{ if .Pre }}<i class="{{ .Pre }} mr-2"></i>{{ end }}{{ .Name }}
            </a>
          </li>
          {{ end }}
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center footer-copyright">
        {{ .Site.Params.copyright | markdownify }}
      </div>
    </div>
  </div>
</footer>

<a href="#" id="return-to-top" class="cursor-pointer">
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
    style="width: 24px; height: 24px;">
    <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
  </svg>
</a>
<a href="#" id="go-to-bottom" class="cursor-pointer">
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
    style="width: 24px; height: 24px;">
    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
  </svg>
</a>

<script>
  var indexURL = "{{ "index.json" | absURL | safeJS }}";
</script>

{{ "<!-- JS Plugins -->" | safeHTML }}
{{ range .Site.Params.plugins.js}}
<script src="{{ .URL | absURL }}" {{ if .async }}async{{ end }} {{ if .defer }}defer{{ end }}></script>
{{ end }}

{{ "<!-- Main script with TypeScript support -->" | safeHTML }}
{{ $script := resources.Get "js/script.ts" | js.Build (dict "minify" true) }}
<script src="{{ $script.Permalink }}"></script>

{{ "<!-- UI logic bundle with TypeScript -->" | safeHTML }}
{{ $ui := resources.Get "js/index.ts" | js.Build (dict "minify" true) }}
<script src="{{ $ui.Permalink }}"></script>

{{ if eq .Section "search" }}
{{ "<!-- Search logic with TypeScript -->" | safeHTML }}
{{ $search := resources.Get "js/search.ts" | js.Build (dict "minify" true) }}
<script src="{{ $search.Permalink }}"></script>
{{ end }}

<!-- Newsletter Script placeholder (Logic moved to TypeScript) -->

<!-- cookie -->
{{ if site.Params.cookies.enable }}
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"
  integrity="sha256-P8jY+MCe6X2cjNSmF4rQvZIanL5VwUUT4MBnOMncjRU=" crossorigin="anonymous"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide"
  data-cookie-expire="{{ site.Params.cookies.expire_days | default 1 }}">
  <div class="container">
    <div class="cookie-content">
      <p>本網站使用Cookie來改善您的瀏覽體驗。繼續使用本網站，即表示您同意我們的Cookie使用政策。</p>
      <div class="cookie-buttons">
        <button id="js-cookie-button" class="btn btn-sm btn-primary">我接受</button>
        <a href="{{ .Site.Params.cookies.policy_url }}" class="btn btn-sm btn-outline-secondary ml-2">了解更多</a>
      </div>
    </div>
  </div>
</div>
{{ end }}