{{ define "main" }}
{{- $cat_class := "" -}}
{{- with .Params.categories -}}
    {{- if reflect.IsSlice . -}}
        {{- if gt (len .) 0 -}}
            {{- $cat_class = printf "category-%s" ((index . 0) | urlize) -}}
        {{- end -}}
    {{- else if reflect.IsString . -}}
        {{- $cat_class = printf "category-%s" (. | urlize) -}}
    {{- end -}}
{{- end -}}
<section class="section-sm {{ $cat_class }}">
  <div class="container">
    <div class="row">
      {{ partial "sidebar.html" . }}
      <div class="col-lg-8">
        {{ range .Params.Categories }}
        <a href="{{ `categories/` | relLangURL }}{{ . | urlize | lower }}" class="text-primary">{{ . | title | humanize }}</a>
        {{ end }}
        <h2>{{ .Title | markdownify }}</h2>
        <div class="mb-3 post-meta">
          <span>By {{if .Params.Author}}{{ .Params.Author }}{{else}}{{.Site.Params.Author}}{{end}}</span>
          {{ if not .Params.HideDate }}
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>{{ .PublishDate.Format "02 January 2006" }}</span>
          {{ end }}
        </div>
        

        <div class="content mb-5 post-content">
          {{ .Content }}
        </div>

        <!-- 綜合導航區 -->
        <div class="navigation-container">
          <!-- 上一篇/下一篇 -->
          <div class="post-navigation">
            <div class="row">
              <div class="col-md-6">
                {{ with .PrevInSection }}
                  <div class="prev-post">
                    <span>上一篇</span>
                    <a href="{{ .RelPermalink }}">
                      <h5>{{ .Title }}</h5>
                    </a>
                  </div>
                {{ end }}
              </div>
              <div class="col-md-6 text-right">
                {{ with .NextInSection }}
                  <div class="next-post">
                    <span>下一篇</span>
                    <a href="{{ .RelPermalink }}">
                      <h5>{{ .Title }}</h5>
                    </a>
                  </div>
                {{ end }}
              </div>
            </div>
          </div>
          
          <!-- 導航選項卡（只保留相關文章和最新文章） -->
          <div class="navigation-tabs mt-5">
            <ul class="nav nav-tabs" id="navigationTabs" role="tablist">
              <li class="nav-item">
                <a class="nav-link active" id="related-tab" data-toggle="tab" href="#related" role="tab">相關文章</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="latest-tab" data-toggle="tab" href="#latest" role="tab">最新文章</a>
              </li>
            </ul>
<div class="tab-content" id="navigationTabsContent">
  
  <div class="tab-pane fade show active" id="related" role="tabpanel">
    <div class="row mt-4">
      
      {{ $related := .Site.RegularPages.Related . | first 6 }}
      {{ with $related }}
        {{ range . }}
        <div class="col-12">
          <article class="widget-card">
            <div class="d-flex">
              <div class="ml-3">
                <h5><a class="post-title" href="{{ .RelPermalink }}">{{ .Title }}</a></h5>
                <ul class="list-inline meta-info">
                  <li class="list-inline-item"><a href="/about">{{ .Params.Author | default .Site.Params.Author }}</a></li>
                  <li class="list-inline-item">{{ .PublishDate.Format "Jan 2, 2006" }}</li>
                </ul>
              </div>
            </div>
          </article>
        </div>
        {{ end }}
      {{ else }}
        <div class="col-12">
          <p class="text-muted">目前沒有相關文章</p>
        </div>
      {{ end }}
      </div>
  </div>

  <div class="tab-pane fade" id="latest" role="tabpanel">
    <div class="row mt-4">
      
      {{ $recent := .Site.RegularPages.ByDate.Reverse | first 6 }}
      {{ range $recent }}
      <div class="col-12">
        <article class="widget-card">
          <div class="d-flex">
            <div class="ml-3">
              <h5><a class="post-title" href="{{ .RelPermalink }}">{{ .Title }}</a></h5>
              <ul class="list-inline meta-info">
                <li class="list-inline-item"><a href="/about">{{ .Params.Author | default .Site.Params.Author }}</a></li>
                <li class="list-inline-item">{{ .PublishDate.Format "Jan 2, 2006" }}</li>
              </ul>
            </div>
          </div>
        </article>
      </div>
      {{ end }}
      </div>
  </div>

</div>
          </div>
        </div>

        <!-- comments -->
        {{ template "_internal/disqus.html" . }}
      </div>
    </div>
  </div>
</section>
{{ end }}
